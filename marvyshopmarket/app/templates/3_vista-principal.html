{% extends 'base.html' %}

{% block title %}Marvy Shopmarket | Home {% endblock %}

{% block content %}
    {% if estado==1 %}
        <div id="content-login">

        </div>
        <div class="mensaje" style="display: flex;">
            <p class="mensaje-content" style="color: var(--btn-claro-continuar);">{{mensaje}}<br><img src="{{ url_for('static', filename='images/comprobado.png') }}" alt="comprobado" width=30%></p>

        </div>
        <script>
            function redirigirDespuesDeTiempo() {
            setTimeout(function() {
                window.location.href = "{{ url_for('main.home') }}";
            }, 2000);
            }
        redirigirDespuesDeTiempo()
        </script>
        {% elif estado==0 %}
        <div class="mensaje" style="display: flex;">
            <p class="mensaje-content" style="color: var(--btn-claro-cancelar);">{{mensaje}}<br><img src="{{ url_for('static', filename='images/error.png') }}" alt="comprobado" width=30%></p>
        </div>

        <script>
            function redirigirDespuesDeTiempo() {
            setTimeout(function() {
                window.location.href = "{{ url_for('main.login') }}";
            }, 2000);
            }
        redirigirDespuesDeTiempo()
        </script>

        {% elif estado==2 %}
        <div class="mensaje">
            <p class="mensaje-content">{{mensaje}}</p>
        </div>
        <script>
            function redirigirDespuesDeTiempo() {
            setTimeout(function() {
                window.location.href = "{{ url_for('main.login') }}";
            }, 2000);
            }
        redirigirDespuesDeTiempo()
        </script>
    {% endif %}

    <div id="container-home">

        <div class="menu">
            <div><button id="menu-hamburguesa"><img src="{{url_for('static', filename='images/menu(1).png')}}" width="40%"></button></div>
        </div>
        <div class="menu-desplegable" id="menu-desplegable">
            <div class="menu-desplegable-content">
                <div><button class="cerrar" style="background: none; border: none;"><i class="fa-solid fa-circle-xmark" id="btn-cerrar"></i></button></div>
                <div class="imagen_perfil_content">
                    <div class="imagen_perfil">
                        <div><img src="data:image/png;base64,{{ informacion_tienda.imagen }}" width="50%" style="border-radius: 50%;" alt="Imagen de la Tienda"></div>
                    </div>
                </div>
                <div><h2>{{informacion_tienda.nombre}}<br>{{perfil}}</h2></div>
                {% if perfil=="tendero" %}
                    <div><h3>{{informacion_tendero.nombre}}</h3></div>
                {% endif %}
                <div class="listado">
                    <div>
                        <ul>
                            <li><p><i class="fa-solid fa-file" ></i> Generar Informe</p></li>
                            {% if perfil=="administrador" %}
                                <li><p><i class="fa-solid fa-filter-circle-dollar"></i> Registro de gastos</p></li>
                                <a href="registro-tendero"><li><i class="fa-solid fa-user"></i> Registrar tendero</li></a>
                            {% endif %}

                            <a href="/ajustes-generales"><li><i class="fa-solid fa-gear"></i> Ajustes</li></a>
                        </ul>
                    </div>
                    <div class="boton-salir">
                        <div><form action="/cerrar-sesion" method="GET"><button style="color: var(--blanco)"><div>Cerrar sesión</div><i class="fa-solid fa-door-open btn-principal"></i></button></form></div>
                    </div>
                </div>
            </div>
        </div>
        <form  class="buscador" action="/buscar" method="post">
            <button type="submit">Buscar</button>
        </form>
        {%if state==1%}
        <div style="position: absolute; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center;" id="buscador-container">
            <div style="padding: 2%; width:50% ; height: auto; background: var(--blanco); color: var(--negro);">
                <div><button class="cerrar_dos" style="background: none; border: none;"><i class="fa-solid fa-circle-xmark" id="btn-cerrar"></i></button></div>
                <form  style="display: flex; align-items: center; justify-content: center; flex-direction: column;" class="buscador" action="/resultado" method="post">
                    <h3>Buscar</h3>
                    <input type="text" name="texto_busqueda" placeholder="Buscar productos..." style="width: 80%;">
                    <input type="submit" value="Buscar" style="cursor: pointer; width: 80%;">
                    <h3>Resultados</h3>
                    <table style="width: 80%;">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Precio</th>
                                <th>Existencias</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for producto in productos %}
                            <tr>
                                <td>{{ producto.prod_Nombre }}</td>
                                <td>${{ producto.prod_Precio }}</td>
                                <td>{{producto.prod_Cantidad}}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
        {%elif state==0%}
        <div>
            <p>Hola desde estado 0</p>
        </div>
        {%endif%}
        <div class="titulo">
            <div><h1>{{ informacion_tienda.nombre }}</h1></div>
        </div>
        <div><p>{{informacion_tienda.ubicacion}}</p></div>
        <!-- <div class="nombre-img">
            <div class="imagen-perfil">
                <img src="data:image/png;base64,{{ informacion_tienda.imagen }}" width="50%" alt="Imagen de la Tienda">
            </div>
            <div><h3>{{informacion_tienda.nombre}}</h3></div>
        </div> -->
        <div class="botom">
            {% if perfil=="administrador" %}
                <div class="action">
                    <div><form action="/ventas" method="GET"><button>Ventas</button></form></div>
                    <div><img src="{{ url_for('static', filename='images/personal.png') }}" style="width: 150px;"></div>
                </div>
                
                <div class="action">
                    <div><form action="/suministros" method="GET"><button>Suministros</button></form></div>
                    <div><img src="{{ url_for('static', filename='images/distribucion.png') }}" style="width: 150px;"></div>
                </div>
                <div class="action">
                    <div><form action="/productos" method="GET"><button>Productos</button></form></div>
                    <div><img src="{{ url_for('static', filename='images/nuevo-producto.png') }}" style="width: 150px;"></div>
                </div>
                <div class="action">
                    <div><form action="/registro-proveedores" method="GET"><button>Proveedores</button></form></div>
                    <div><img src="{{ url_for('static', filename='images/repartidor.png') }}" style="width: 150px;"></div>
                </div>
            {% elif perfil=="tendero" %}
                <div  style="grid-column: 2/4; width: 100%; display: flex; text-align: center; justify-content: center;">
                    <div class="action" style="width: 50%;">
                        <div><form action="/registro-ventas" method="GET"><button>Ventas</button></form></div>
                        <div><img src="{{ url_for('static', filename='images/personal.png') }}" style="width: 150px;"></div>
                    </div>
                </div>
            {% else %}
                <div><h1>ERROR 404</h1></div>
            {% endif %}
            <div class="totales">
                <div>
                    <h4>Total De Venta:</h4>
                    <p>$_______</p>
                </div>
                <div>
                    <h4>Total De Gastos:</h4>
                    <p>$_______</p>
                </div>
                <div>
                    <h4>Total De Neto:</h4>
                    <p>$_______</p>
                </div>
            </div>
        </div>
        
        <footer><p>© Marvy Shopmarket</p></footer>
    </div>

{% endblock %}
